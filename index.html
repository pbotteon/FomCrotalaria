<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Formul√°rio de An√°lise de Risco - Intoxica√ß√£o por Crotal√°ria</title>
  <style>
    .hidden { display: none; }
    .container { max-width: 800px; margin: 0 auto; padding: 20px; font-family: Arial, sans-serif; }
    .button-group { margin-top: 20px; }
    .form-section { margin-top: 20px; }
    label { display: block; margin-top: 10px; }
    input, select, textarea { width: 100%; padding: 8px; box-sizing: border-box; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üèè Formul√°rio de An√°lise de Risco</h1>
      <h2>Intoxica√ß√£o por Crotal√°ria em Equinos</h2>
    </div>

    <!-- P√°gina de consentimento -->
    <div class="section" id="consent-section">
      <h2>Termo de Consentimento</h2>
      <div class="consent-terms">
        <p>Voc√™ est√° sendo convidado a participar, como volunt√°rio, de um estudo cient√≠fico que tem como objetivo analisar os fatores de risco envolvidos na ocorr√™ncia de casos de intoxica√ß√£o por plantas do g√™nero <i>Crotal√°ria</i> em equinos alimentados com concentrado industrializado.</p>
        <p>Este estudo faz parte de uma investiga√ß√£o vinculada √† Universidade Federal Rural do Rio de Janeiro. Sua colabora√ß√£o √© fundamental para compreendermos melhor a epidemiologia dessa intoxica√ß√£o e prevenir novos casos.</p>
        <ul>
          <li>Os dados ser√£o utilizados exclusivamente para fins cient√≠ficos.</li>
          <li>As informa√ß√µes coletadas ser√£o tratadas de forma confidencial.</li>
          <li>Voc√™ poder√° se recusar a responder qualquer pergunta ou encerrar sua participa√ß√£o a qualquer momento, sem nenhum preju√≠zo.</li>
        </ul>
      </div>
      <div class="consent-checkbox">
        <input type="checkbox" id="consent-checkbox" />
        <label for="consent-checkbox">Li e concordo com os termos acima</label>
      </div>
      <div class="button-group">
        <button id="start-button" type="button">Iniciar Formul√°rio</button>
      </div>
    </div>

    <!-- Parte 1: Dados da Propriedade -->
    <div class="section hidden" id="part1-section">
      <h2>1. Dados da Propriedade</h2>
      <label for="propriedade">Nome da Propriedade:</label>
      <input type="text" id="propriedade" />
      <label for="proprietario">Nome do Propriet√°rio:</label>
      <input type="text" id="proprietario" />

      <label for="municipio">Munic√≠pio:</label>
      <input type="text" id="municipio" />

      <label for="estado">Estado:</label>
      <select id="estado">
        <option value="">Selecione</option>
        <option value="BA">BA</option>
        <option value="ES">ES</option>
        <option value="GO">GO</option>
        <option value="MG">MG</option>
        <option value="RJ">RJ</option>
        <option value="SP">SP</option>
      </select>

      <div class="button-group">
        <button type="button" onclick="nextSection('part3-section')">Pr√≥ximo</button>
      </div>
    </div>

    <!-- Parte 3: Dados Cl√≠nicos do Animal -->
    <div class="section hidden" id="part3-section">
      <h2>3. Dados Cl√≠nicos do Animal</h2>

      <label for="animal-id">Identifica√ß√£o do Animal:</label>
      <input type="text" id="animal-id" />

      <label for="especie">Esp√©cie:</label>
      <select id="especie">
        <option value="">Selecione</option>
        <option value="equino">Equino</option>
        <option value="muar">Muar</option>
        <option value="asinino">Asinino</option>
      </select>

      <label for="idade">Idade (anos):</label>
      <input type="number" id="idade" min="0" />

      <label for="sexo">Sexo:</label>
      <select id="sexo">
        <option value="">Selecione</option>
        <option value="macho">Macho</option>
        <option value="femea">F√™mea</option>
      </select>

      <fieldset id="sintomas">
        <legend>Selecione os sintomas observados:</legend>
        <label><input type="checkbox" name="sintomas" value="apatia"> Apatia</label>
        <label><input type="checkbox" name="sintomas" value="emagrecimento"> Emagrecimento progressivo</label>
        <label><input type="checkbox" name="sintomas" value="fotossensibilizacao"> Fotossensibiliza√ß√£o</label>
        <label><input type="checkbox" name="sintomas" value="edema"> Edema de prep√∫cio/vulva</label>
        <label><input type="checkbox" name="sintomas" value="ictericia"> Icter√≠cia</label>
        <label><input type="checkbox" name="sintomas" value="lesoes-orais"> Les√µes orais</label>
        <label><input type="checkbox" name="sintomas" value="ataxia"> Ataxia</label>
        <label><input type="checkbox" name="sintomas" value="decubito"> Dec√∫bito</label>
        <label><input type="checkbox" name="sintomas" value="cegueira"> Cegueira</label>
        <label><input type="checkbox" name="sintomas" value="tremores"> Tremores musculares</label>
        <label><input type="checkbox" name="sintomas" value="respiracao"> Dificuldade respirat√≥ria</label>
        <label><input type="checkbox" name="sintomas" value="diarreia"> Diarreia</label>
        <label><input type="checkbox" name="sintomas" value="anemia"> Anemia</label>
        <label><input type="checkbox" name="sintomas" value="comportamento"> Altera√ß√£o comportamental</label>
        <label><input type="checkbox" name="sintomas" value="outros"> Outros (especifique abaixo):</label>
        <textarea id="sintomas-outros" placeholder="Descreva outros sintomas"></textarea>
      </fieldset>

      <h3>Par√¢metros Bioqu√≠micos (se dispon√≠veis)</h3>
      <label for="gama-gt">GGT:</label>
      <input type="text" id="gama-gt" />

      <label for="ast">AST:</label>
      <input type="text" id="ast" />

      <label for="bilirrubina">Bilirrubina Total:</label>
      <input type="text" id="bilirrubina" />

      <label for="fibrinogenio">Fibrinog√™nio:</label>
      <input type="text" id="fibrinogenio" />

      <label for="proteinas">Prote√≠nas Totais:</label>
      <input type="text" id="proteinas" />

      <label for="albumina">Albumina:</label>
      <input type="text" id="albumina" />

      <label for="ureia">Ureia:</label>
      <input type="text" id="ureia" />

      <label for="creatinina">Creatinina:</label>
      <input type="text" id="creatinina" />

      <label for="desfecho">Desfecho Cl√≠nico:</label>
      <select id="desfecho">
        <option value="">Selecione</option>
        <option value="√≥bito">√ìbito</option>
        <option value="recupera√ß√£o">Recupera√ß√£o</option>
        <option value="eutanasia">Eutan√°sia</option>
        <option value="outro">Outro</option>
      </select>

      <div class="button-group">
        <button type="button" onclick="backSection('part1-section')">Voltar</button>
        <button type="button" onclick="nextSection('part4-section')">Pr√≥ximo</button>
      </div>
    </div>

    <!-- Parte 4: Observa√ß√µes Finais -->
    <div class="section hidden" id="part4-section">
      <h2>4. Observa√ß√µes Finais</h2>
      <label for="observacoes">Observa√ß√µes:</label>
      <textarea id="observacoes"></textarea>

      <div class="button-group">
        <button type="button" onclick="backSection('part3-section')">Voltar</button>
        <button type="button" onclick="submitForm()">Adicionar Animal</button>
        <button type="button" onclick="finalizarEnvio()">Finalizar e Enviar Todos</button>
      </div>

      <div id="animal-warning" style="display: none; background-color: #fff3cd; border-left: 6px solid #ffc107; padding: 16px; margin-top: 20px;">
        <strong>Aten√ß√£o:</strong> Ap√≥s o envio dos dados de um animal, preencha os dados do pr√≥ximo sobrescrevendo os campos anteriores e clique novamente em "Enviar Formul√°rio".
      </div>
    </div>
  </div>

  <script>
    const animais = [];
    let dadosPropriedade = {};
    let currentStep = 1;

    function startForm() {
      if (!document.getElementById("consent-checkbox").checked) {
        alert("√â necess√°rio aceitar os termos para iniciar o formul√°rio.");
        return;
      }
      showSection("part1-section");
    }

    function showSection(id) {
      document.querySelectorAll(".section").forEach(sec => sec.classList.add("hidden"));
      document.getElementById(id).classList.remove("hidden");
    }

    function nextSection(nextId) {
      currentStep++;
      showSection(nextId);
    }

    function backSection(prevId) {
      currentStep--;
      showSection(prevId);
    }

    function submitForm() {
      if (Object.keys(dadosPropriedade).length === 0) {
        dadosPropriedade = {
          propriedade: document.getElementById("propriedade").value,
          proprietario: document.getElementById("proprietario").value,
          municipio: document.getElementById("municipio").value,
          estado: document.getElementById("estado").value
        };
      }

      const dados = {
        animalId: document.getElementById("animal-id").value,
        especie: document.getElementById("especie").value,
        idade: document.getElementById("idade").value,
        sexo: document.getElementById("sexo").value,
        desfecho: document.getElementById("desfecho").value,
        sintomas: Array.from(document.querySelectorAll('input[name="sintomas"]:checked')).map(e => e.value).concat(document.getElementById("sintomas-outros").value).filter(Boolean).join(', '),
        gamaGT: document.getElementById("gama-gt").value,
        ast: document.getElementById("ast").value,
        bilirrubina: document.getElementById("bilirrubina").value,
        fibrinogenio: document.getElementById("fibrinogenio").value,
        proteinas: document.getElementById("proteinas").value,
        albumina: document.getElementById("albumina").value,
        ureia: document.getElementById("ureia").value,
        creatinina: document.getElementById("creatinina").value,
        observacoes: document.getElementById("observacoes").value
      };

      animais.push(dados);
      console.clear();
      console.log("üìÑ Animal registrado:", dados);
      console.log("üìä Total de animais registrados:", animais.length);

      document.getElementById("animal-warning").style.display = "block";
      alert("Formul√°rio enviado com sucesso. Voc√™ pode inserir os dados do pr√≥ximo animal.");
    }

    function finalizarEnvio() {
      if (animais.length === 0) {
        alert("Nenhum animal registrado.");
        return;
      }
      const pacoteFinal = {
        propriedade: dadosPropriedade,
        animais: animais
      };
      console.log("üì¶ Enviando todos os dados:", pacoteFinal);
      alert("Todos os dados foram preparados para envio ao Google Sheets.");
      // Aqui entrar√° a integra√ß√£o com Zapier/Sheets
    }

    document.addEventListener("DOMContentLoaded", () => {
      const checkbox = document.getElementById("consent-checkbox");
      const startButton = document.getElementById("start-button");

      startButton.disabled = !checkbox.checked;
      checkbox.addEventListener("change", () => {
        startButton.disabled = !checkbox.checked;
      });

      startButton.addEventListener("click", startForm);
    });
  </script>
</body>
</html>
